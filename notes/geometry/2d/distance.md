# Расстояния
## Точка
Дана точка $A(x_0, y_0)$, нужно найти расстояние до объектов:

**Точка.** Найти расстояние между двумя точками. Самый лёгкий случай, достаточно найти длину вектора между ними: $len(A - B)$

**Прямая.** Если прямая задана двумя точками $BC$, то можно воспользоваться определением векторного произведения: *площадь параллелограма*, образованным двумя векторами. Также его площадь равна переменожению *высоты* на *основание*. Высота и является расстоянием до прямой, основанием будет является отрезок $BC$:

$$
\begin{aligned}
|\vec{BA} \times \vec{BC}| &= h \cdot |\vec{BC}| \\
h &= \cfrac{|\vec{BA} \times \vec{BC}|}{|\vec{BC}|}
\end{aligned}
$$

Так как векторное произведение может быть отрицательным, то берём его по модулю.

Если же прямая задана *уравнением*, то есть 1 замечательная формула:

$$
h = \cfrac{|Ax_0 + By_0 + C|}{\sqrt{A^2 + B^2}}
$$

Объяснение: можно сказать, что мы взяли *перпендикулярный* вектор $(A, B)$ и нашли *проекцию* на него нашей исходной точки, с помощью скалярного произведения $(A, B) \cdot (x_0, y_0)$, при это *отнормировав* его изначально, домножив на $\cfrac{1}{\sqrt{A^2 + B^2}}$ ; В знаменателе $+C$ нужен для прямой, которая не проходит через начало координат, и прибавлением $+\cfrac{C}{\sqrt{A^2 + B^2}}$  всё решается. Ну и конечно, берём результат по модулю.

%% TODO: возможно добавить визуализацию %%

**Луч.** Теперь задан луч $BC$. *Поделим* плоскость на 2 полуплоскости с помощью прямой, перпендикулярной и проходящей через точку $B$. Тогда в одной полуплоскости, когда точка "за" лучом, будет расстояние $BC$, а в другой полуплоскости, будет такой же случай, как от точки до прямой.

**Отрезок.** Воспользуемся идеей предыдущей задачи, но теперь разделим плоскость на 3 части:
- Если точка $A$ за точкой $B$, $\vec{BC} \cdot \vec{BA} < 0$, то ответ равен расстоянию $BA$
- Если точка $A$ за точкой $C$, $\vec{CB} \cdot \vec{CA} < 0$, то ответ равен расстоянию $CA$
- Во всех остальный случаях исходная точка расположена "между" отрезком, а значит равно расстоянию от точки до прямой.

![](/files/DistanceDotToSegment.mp4)

## Отрезок
**Отрезок.** Даны 2 отрезка $AB$ и $CD$, нужно найти расстояние между ними.

Если отрезки пересекаются, то очевидно, что ответ 0.

Рассмотрим отрезки, которые не параллельны. Пусть у нас есть какие-то 2 точки на разных отрезках. Сформируем ключевое утверждение:

**Утверждение.** Если 2 точки не равны концам отрезка, то так как они не равны (нет пересечений) и не параллельны между собой, то можно сдвинуть какую-либо точку в каком-либо направлении (всего 4 варианта) так, чтобы результат улучшился.

Небольшое **доказательство**: какую-либо из точек нельзя сдвинуть только в том случаи, когда она образует *перпендикуляр* или является *конечной*. Значит 2 точки нельзя сдвинуть, если они оба являются *перпендикуляром*, однако такое возможно лишь когда прямые *параллельны*, что не соответствует условию.

Из данного утверждения следует, что какая-либо из точек является конечной. А расстояние от точки до отрезка мы уже искать умеем. А значит нам нужно взять минимум из всех четырёх расстояний:

$$
d = \min
\begin{cases}
distance(A, CD) \\
distance(B, CD) \\
distance(C, AB) \\
distance(D, AB)
\end{cases}
$$

На самом деле данное утверждение расширяется и на параллельные прямые, и можно использовать ту же формулу.

![](/files/DistanceSegments.gif)