# 2-SAT
**Задача.** У нас есть какие-то переменные $a, b, c, d, \dots$ Нам нужно найти такие бинарные значения, которые соответствуют условиям вида $(a \lor b) \land (\lnot b \lor c) \land ...$ Где операция $\land$ - логическое И, а $\lor$ - ИЛИ, $\lnot$ - НЕ

Заметим, что если в первой скобке $a$ неверно, то $b$ обязательно верно, и наоборот. Тогда можно записать все логические выражения импликацией (обозначение импликации $p \to g$ означает, что если $p$ верно, то $g$ тоже верно):

$$
(a \lor b) = (\lnot a \to b)\land(\lnot b \to a)
$$

Построим граф импликаций: для каждой переменной обозначим 2 вершины: $a$ и $\lnot a$.

![](/files/2-SAT.png)

Если предположить, что какое-то значение верно, то все значения, следующие из него, тоже верны.

Заметим, что если из $a$ следует $\lnot a$, и наоборот, то решения нет. Другими словами: если переменная и отрицание переменной лежат в одной *компоненте сильной связности*, то решения нет. 

*Сконденсируем* граф. Будем считать, что компоненты двусвязности топологически отсортированы(по нашему алгоритму конденсации это всегда верно): если $a \to b \implies c_a \le c_b$ Тогда, если $c[a] > c[\lnot a]$, то выбираем $a$, иначе $\lnot a$. Так как компоненты двусвязности топологически отсортированы, то если $c_a > c_b$ то пути из $a$ в $b$ нет, а в нашем контексте из $a$ не достижима $\lnot a$.
